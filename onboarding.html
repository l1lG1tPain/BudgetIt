<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <link rel="stylesheet" href="theme.css">
  <link rel="stylesheet" href="style.css">
  <link rel="manifest" href="manifest.json?v=2.10.1">

  <script defer
        src="https://cloud.umami.is/script.js"
        data-website-id="bdde8040-4b94-4ae7-ad56-92a613dd4502"
        data-auto-track="false"></script>

  <script src="https://pwastat.ru/pwa_stats.php?id=406&token=4577f71b4b8147e853ec7a90eb82efdfd7eb8fd3af0199d3e654c09b3c2c4741"></script>

  <meta name="theme-color" content="#000000">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="mobile-web-app-title" content="BudgetIt">
  <link rel="icon" href="/assets/favicon.ico" type="image/x-icon">
  <link rel="icon" href="https://budgetit.app/assets/favicon.ico" type="image/x-icon">
  <link rel="apple-touch-icon" href="assets/icon-512x512v2.10.png">
  
  <meta name="description"
        content="BudgetIt ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è PWA –¥–ª—è —É—á—ë—Ç–∞ –¥–æ—Ö–æ–¥–æ–≤, —Ä–∞—Å—Ö–æ–¥–æ–≤, –≤–∫–ª–∞–¥–æ–≤ –∏ –¥–æ–ª–≥–æ–≤ —Å –æ—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º–æ–º, –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π –∏ –ø—É—à-–Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è–º–∏. –ê–∫—É–ª–∫–∞ –ø–æ–∑–∞–±–æ—Ç–∏—Ç—Å—è –æ –≤–∞—à–∏—Ö —Ñ–∏–Ω–∞–Ω—Å–∞—Ö!">
  <meta name="keywords" content="—É—á—ë—Ç –±—é–¥–∂–µ—Ç–∞, PWA –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —Ñ–∏–Ω–∞–Ω—Å—ã, —Ä–∞—Å—Ö–æ–¥—ã, –¥–æ—Ö–æ–¥—ã, –∞–∫—É–ª–∫–∞, BudgetIt, –ª–∏—á–Ω—ã–µ —Ñ–∏–Ω–∞–Ω—Å—ã, —Ç—Ä–µ–∫–µ—Ä —Ç—Ä–∞—Ç, –æ—Ñ–ª–∞–π–Ω –±—é–¥–∂–µ—Ç">
  <meta name="author" content="BudgetIt by l1lG1tPain">
  <meta name="robots" content="index, follow">
  <link rel="canonical" href="https://budgetit-nine.vercel.app/">

  <!-- === OPEN GRAPH === -->
  <meta property="og:type"        content="website">
  <meta property="og:url"         content="https://budgetit-nine.vercel.app/">
  <meta property="og:site_name" content="BudgetIt">
  <meta property="og:title"       content="BudgetIt ‚Äî Track your money with Shark ü¶à">
  <meta property="og:description" content="Zero-friction budgeting PWA: incomes, expenses, deposits, debts, dark mode & offline. Install and let the Shark guard your wallet.">
  <meta property="og:image"       content="https://budgetit-nine.vercel.app/assets/og-cover.png">
  <meta property="og:locale"      content="ru_RU">
  <meta property="og:locale:alternate" content="en_US">

  <!-- === TWITTER === -->
  <meta name="twitter:site" content="@CyberSnit4">
  <meta name="twitter:card"        content="summary_large_image">
  <meta name="twitter:title"       content="BudgetIt ‚Äî –ê–∫—É–ª–∫–∞ —Å–ª–µ–¥–∏—Ç –∑–∞ —Ç–≤–æ–∏–º –±—é–¥–∂–µ—Ç–æ–º">
  <meta name="twitter:description" content="–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è PWA –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–∏—á–Ω—ã–º–∏ —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏. –£—Å—Ç–∞–Ω–æ–≤–∏ –∏ –Ω–∞—á–Ω–∏ —ç–∫–æ–Ω–æ–º–∏—Ç—å —É–∂–µ —Å–µ–≥–æ–¥–Ω—è.">
  <meta name="twitter:image"       content="https://budgetit-nine.vercel.app/assets/og-cover.png">

  <meta name="theme-color" content="#000000">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="BudgetIt">
  <link rel="apple-touch-icon" href="assets/icon-512x512v2.9.png">      
  <title>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BudgetIt</title>

  <style>
    :root {
      --onboarding-radius: var(--border-radius-lg, 16px);
    }

    html, body {
      margin: 0;
      padding: 0;
    }

    body {
      font-family: 'Montserrat', 'sans-serif';
      background-color: #000;
      color: #fff;
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: stretch;
      box-sizing: border-box;
      padding: 24px 16px;
      text-align: left;
      overflow-y: auto; /* ‚úÖ —Ç–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ —Å–∫—Ä–æ–ª–ª–∏—Ç—å –Ω–∞ –º–∞–ª–µ–Ω—å–∫–∏—Ö —ç–∫—Ä–∞–Ω–∞—Ö */
      user-select: none;
    }

    .onboarding-root {
      width: 100%;
      max-width: 480px;
      margin: 0 auto;
    }

    .onboarding-header {
      display: flex;
      justify-content: flex-start;
      margin-bottom: 16px;
    }

    .onboarding-pill {
      font-size: 0.8rem;
      padding: 4px 10px;
      border-radius: 999px;
      background: rgba(0,0,0,0.4);
      border: 1px solid rgba(255,255,255,0.08);
      color: #fff;
      backdrop-filter: blur(12px);
      align-items: center;
      display: flex;
    }

    .onboarding-main {
      display: flex;
      justify-content: center;
      align-items: center;
      background-color: #000;
    }

    .onboarding-card {
      position: relative;
      width: 100%;
      padding: 20px 18px 22px;
      border-radius: var(--onboarding-radius);
      background: radial-gradient(circle at top left, rgb(5 69 32), transparent 55%), radial-gradient(circle at bottom right, rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.95));
      /* border: 1px solid rgba(255,255,255,0.06); */
      box-shadow: 0 16px 40px rgba(0,0,0,0.65);
      overflow: hidden;
    }

    .onboarding-card::before {
      content: "";
      position: absolute;
      inset: -40%;
      background: radial-gradient(circle at 10% 0%, rgba(255,255,255,0.12), transparent 55%);
      opacity: 0.4;
      pointer-events: none;
    }

    .onboarding-inner {
      position: relative;
      z-index: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 12px;
    }

    .onboarding-logo {
      max-width: 220px;
      border-radius: 20px;
      margin-bottom: 4px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.7);
    }

    h1 {
      font-size: 1.5rem;
      margin: 0;
    }

    p.onboarding-text {
      font-size: 0.95rem;
      margin: 4px 0 14px;
    }

    .onboarding-form {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: stretch;
      gap: 10px;
      margin-top: 4px;
    }

    .field-label {
      align-self: flex-start;
      font-size: 0.8rem;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: #fff;
      margin-bottom: -4px;
    }

    input[type="text"] {
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.18);
      background: rgb(24, 23, 23);
      color: #fff;
      /* font-size: 1rem; */
      width: 100%;
      box-sizing: border-box;
      font-family: 'Montserrat', 'sans-serif';
    }

    input[type="text"]::placeholder {
      color: var(--text-muted);
      opacity: 0.9;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: var(--primary-color);
      box-shadow: 0 0 0 1px rgba(255,255,255,0.1);
    }

    .onboarding-btn {
      border: none;
      border-radius: 12px;
      padding: 12px 16px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      width: 100%;
      box-sizing: border-box;
      display: inline-flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      transition: transform 0.1s ease, box-shadow 0.2s ease, background 0.2s ease;
    }

    .onboarding-btn-primary {
      background: linear-gradient(135deg, var(--primary-color), var(--income-color));
      color: #000;
      box-shadow: 0 10px 25px rgba(0,0,0,0.6);
    }

    .onboarding-btn-secondary {
      background: #000;
      color: #fff;
      border: 1px solid rgba(255,255,255,0.12);
    }

    .onboarding-btn:hover {
      transform: translateY(-1px);
      box-shadow: 0 14px 30px rgba(0,0,0,0.7);
    }

    .onboarding-btn:active {
      transform: translateY(0);
      box-shadow: 0 4px 12px rgba(0,0,0,0.4);
    }

    #file-input {
      display: none;
    }

    .onboarding-help-link {
      margin-top: 5px;
      font-size: 0.9rem;
      color: var(--primary-color);
      background: none;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 0 0;
    }

    .onboarding-help-link span {
      text-decoration: underline dotted;
    }

    /* ----- –ú–æ–¥–∞–ª–∫–∏ ----- */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background-color: rgba(0, 0, 0, 0.7);
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      padding: 16px;
      box-sizing: border-box;
    }
    .modal-content {
      background-color: #000;
      padding: 20px 18px 22px;
      border-radius: var(--onboarding-radius);
      max-width: 480px;
      width: 100%;
      color: #fff;
      text-align: left;
      border: 1px solid rgba(255,255,255,0.08);
      box-shadow: 0 18px 40px rgba(0,0,0,0.8);
    }
    .modal-content h2 {
      margin-top: 0;
      color: var(--primary-color);
    }
    .close-modal {
      background: none;
      border: none;
      color: var(--accent-color);
      font-size: 1.2em;
      cursor: pointer;
      padding: 0;
      margin-bottom: 8px;
    }

    @media (max-height: 640px) {
      body {
        justify-content: flex-start;
      }
      .onboarding-main {
        align-items: flex-start;
      }
      .onboarding-card {
        margin-top: 8px;
      }
    }
  </style>
</head>

<body>
  <div class="onboarding-root">
    <header class="onboarding-header">
      <span class="onboarding-pill"><img src="/assets/favicon.ico" alt="üí∏" height="25px" width="25px"> BudgetIt ¬∑ onboarding</span>
    </header>

    <main class="onboarding-main">
      <section class="onboarding-card">
        <div class="onboarding-inner">
          <img src="assets/onbording-img.jpg" alt="BudgetIt Shark" class="onboarding-logo" />
          <h1>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ BudgetIt ü¶à</h1>
          <p class="onboarding-text">
            –°–æ–∑–¥–∞–π –Ω–æ–≤—ã–π –±—é–¥–∂–µ—Ç –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π —Å–≤–æ–π, —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞—Å—Ö–æ–¥—ã, –¥–æ–ª–≥–∏ –∏ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏—è.
          </p>

          <div class="onboarding-form">
            <span class="field-label">–ù–∞–∑–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞</span>
            <input
              type="text"
              id="budget-name"
              placeholder="–í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ (–º–æ–∂–Ω–æ —ç–º–æ–¥–∂–∏)"
              autocomplete="off"
            />

            <button class="onboarding-btn onboarding-btn-primary" onclick="createBudget()">
              üöÄ –°–æ–∑–¥–∞—Ç—å –±—é–¥–∂–µ—Ç
            </button>

            <label for="file-input" class="onboarding-btn onboarding-btn-secondary">
              üì• –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±—é–¥–∂–µ—Ç (JSON)
            </label>
            <input type="file" id="file-input" accept="application/json" onchange="importBudget(event)" />
          </div>

          <button type="button" class="onboarding-help-link" onclick="openHelpModal()">
            üìñ <span>–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</span>
          </button>
        </div>
      </section>
    </main>
  </div>

  <div id="help-modal" class="modal hidden" style="display: none;">
    <div class="modal-content">
      <button class="close-modal" onclick="closeHelpModal()">–ó–∞–∫—Ä—ã—Ç—å ‚úñÔ∏è</button>
      <p>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –∞–∫—É–ª–∏–π –∫–ª—É–± —É—á—ë—Ç–∞! ü¶à</p><br>
      <h2>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è BudgetIt?</h2><br>
      <p><strong>1. –°–æ–∑–¥–∞–π –∏–ª–∏ –∏–º–ø–æ—Ä—Ç–∏—Ä—É–π –±—é–¥–∂–µ—Ç.</strong> –≠—Ç–æ —Ç–≤–æ—è –æ—Å–Ω–æ–≤–∞. –ö–∞–∂–¥—ã–π –±—é–¥–∂–µ—Ç ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω—ã–π —É—á—ë—Ç —Ä–∞—Å—Ö–æ–¥–æ–≤, –¥–æ—Ö–æ–¥–æ–≤, –¥–æ–ª–≥–æ–≤ –∏ –≤–∫–ª–∞–¥–æ–≤.</p><br>
      <p><strong>2. –î–æ–±–∞–≤–ª—è–π —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏.</strong> –ú–æ–∂–Ω–æ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å –¥–æ—Ö–æ–¥—ã, —Ç—Ä–∞—Ç—ã, –¥–æ–ª–≥–∏ (–∫–æ–º—É —Ç—ã –¥–æ–ª–∂–µ–Ω –∏–ª–∏ –∫—Ç–æ —Ç–µ–±–µ –¥–æ–ª–∂–µ–Ω), –∏ –¥–∞–∂–µ –≤–∫–ª–∞–¥—ã.</p><br>
      <p><strong>3. –ê–Ω–∞–ª–∏–∑–∏—Ä—É–π.</strong> –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–º–æ–≥—É—Ç –ø–æ–Ω—è—Ç—å, –Ω–∞ —á—Ç–æ —Ç—ã —Ç—Ä–∞—Ç–∏—à—å –±–æ–ª—å—à–µ –≤—Å–µ–≥–æ, –∫–∞–∫–æ–≤ –±–∞–ª–∞–Ω—Å –∏ —Å–∫–æ–ª—å–∫–æ —Ç—ã –¥–æ–ª–∂–µ–Ω –∏–ª–∏ –Ω–∞–∫–æ–ø–∏–ª.</p><br>
      <p><strong>4. –ü–µ—Ä–µ–∫–ª—é—á–∞–π –±—é–¥–∂–µ—Ç—ã –∏ —Å–æ—Ö—Ä–∞–Ω—è–π –¥–∞–Ω–Ω—ã–µ.</strong> –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ. –ú–æ–∂–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –∏ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –±—é–¥–∂–µ—Ç—ã —á–µ—Ä–µ–∑ JSON.</p><br>
    </div>
  </div>

  <script>
      // üîß –ü–æ–º–æ—â–Ω–∏–∫: —Å–æ—Ö—Ä–∞–Ω—è–µ–º —Å—Ç–µ–π—Ç –≤ IndexedDB (AkulkaVault/DeepSeaState/mainShark)
      function saveStateToIndexedDB(newState) {
          if (!('indexedDB' in window)) return;

          const request = indexedDB.open('AkulkaVault', 1);

          request.onupgradeneeded = (event) => {
              const db = event.target.result;
              if (!db.objectStoreNames.contains('DeepSeaState')) {
                  const store = db.createObjectStore('DeepSeaState', { keyPath: 'id' });
                  store.createIndex('id', 'id', { unique: true });
              }
          };

          request.onsuccess = (event) => {
              const db = event.target.result;
              const tx = db.transaction('DeepSeaState', 'readwrite');
              const store = tx.objectStore('DeepSeaState');

              const getReq = store.get('mainShark');
              getReq.onsuccess = () => {
                  const existing = getReq.result || {};
                  const merged = { ...existing, ...newState }; // —Å–æ—Ö—Ä–∞–Ω—è–µ–º userId –∏ –ø—Ä–æ—á–µ–µ
                  store.put({ id: 'mainShark', ...merged });
              };
              getReq.onerror = () => {
                  store.put({ id: 'mainShark', ...newState });
              };
          };

          request.onerror = (event) => {
              console.warn('[Onboarding] IndexedDB open error:', event.target.error);
          };
      }

      // üöÄ –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –±—é–¥–∂–µ—Ç–∞
      function createBudget() {
          const name = document.getElementById('budget-name').value.trim();
          if (!name) return showModal("–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞! –ú–æ–∂–Ω–æ —ç–º–æ–¥–∂–∏");

          const budgets = [{ name, transactions: [] }];
          const currentBudgetIndex = 0;
          const productNames = [];

          // –ü–∏—à–µ–º –≤ localStorage (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
          localStorage.setItem('budgets', JSON.stringify(budgets));
          localStorage.setItem('currentBudgetIndex', String(currentBudgetIndex));
          localStorage.setItem('productNames', JSON.stringify(productNames));

          // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º —Å –Ω–æ–≤–æ–π IndexedDB (AkulkaVault)
          saveStateToIndexedDB({ budgets, currentBudgetIndex, productNames });

          try {
              window.trackSafe?.('onboarding-create-budget', { name });
          } catch (e) {}

          setTimeout(() => {
              location.replace('index.html');
          }, 200);
      }

      // üß† –ü–∞—Ä—Å–µ—Ä –¥–ª—è –∏–º–ø–æ—Ä—Ç–∞
      function parseImportedBudgetData(parsed) {
          let budgets, currentBudgetIndex, productNames;

          if (Array.isArray(parsed)) {
              budgets = parsed;
              currentBudgetIndex = 0;
              productNames = [];
          } else if (parsed && typeof parsed === 'object') {
              budgets = Array.isArray(parsed.budgets) ? parsed.budgets : [];
              currentBudgetIndex = Number.isInteger(parsed.currentBudgetIndex)
                  ? parsed.currentBudgetIndex
                  : 0;
              productNames = Array.isArray(parsed.productNames) ? parsed.productNames : [];
          } else {
              throw new Error('Invalid import format');
          }

          currentBudgetIndex = Math.min(
              Math.max(0, currentBudgetIndex),
              Math.max(0, budgets.length - 1)
          );

          return { budgets, currentBudgetIndex, productNames };
      }

      // üì• –ò–º–ø–æ—Ä—Ç –Ω–∞ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–µ
      function importBudget(event) {
          const file = event.target.files[0];
          if (!file) return;

          const reader = new FileReader();
          reader.onload = () => {
              try {
                  const parsed = JSON.parse(reader.result);
                  const { budgets, currentBudgetIndex, productNames } = parseImportedBudgetData(parsed);

                  // –í localStorage
                  localStorage.setItem('budgets', JSON.stringify(budgets));
                  localStorage.setItem('currentBudgetIndex', String(currentBudgetIndex));
                  localStorage.setItem('productNames', JSON.stringify(productNames));

                  // –í –Ω–æ–≤—É—é IndexedDB
                  saveStateToIndexedDB({ budgets, currentBudgetIndex, productNames });

                  trackSafe?.('onboarding-import-budget', { name: file.name });

                  setTimeout(() => location.replace('index.html'), 200);
              } catch (e) {
                  console.error('[Onboarding import error]', e);
                  showModal('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è JSON —Ñ–∞–π–ª–∞');
              }
          };
          reader.readAsText(file);
      }

      function openHelpModal() {
          const help = document.getElementById('help-modal');
          help.classList.remove('hidden');
          help.style.display = 'flex';
      }

      function closeHelpModal() {
          const help = document.getElementById('help-modal');
          help.classList.add('hidden');
          help.style.display = 'none';
      }

      function showModal(message) {
          const modal = document.createElement('div');
          modal.className = 'modal';
          modal.innerHTML = `
      <div class="modal-content">
        <button class="close-modal" onclick="this.parentElement.parentElement.remove()">–ó–∞–∫—Ä—ã—Ç—å ‚úñÔ∏è</button>
        <h2>–ù—É –∫—É–¥–∞ —Ç—ã?</h2><br>
        <p>${message}</p>
      </div>
    `;
          document.body.appendChild(modal);
      }
  </script>

  <!-- Vercel Analytics -->
  <script defer src="/_vercel/insights/script.js"></script>
  <script type="module" src="./src/utils/analytics.js"></script>
  <script src="./src/utils/umami-events.js" defer></script>

  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js')
        .then(reg => console.log('[SW] Registered', reg))
        .catch(err => console.warn('[SW] Failed', err));
    }
  </script>
</body>
</html>
